---
title: "Religiosity as Influenced by Intersectionality"
shorttitle: "Paper"
abstract: An Abstract
keywords: [keyword1, keyword2]
thanks: Thanks to everyone for checking this out.
reference-section-title: References
bibliography: ../bibliography/project.bib
csl: ../bibliography/chicago-parenthetical.csl
format:
  aog-article-pdf:
    keep-tex: false
    include-in-header: 
      text: |
        \usepackage{dcolumn}
#  submittable-pdf:
#     keep-tex: false
#     fig-pos: "!t"
#     include-in-header: 
#       text: |
#         \usepackage{dcolumn}
  submittable-docx: default
---

```{r}
#| label: setup
#| include: false
library(here)
source(here("utils","check_packages.R"))
source(here("utils","functions.R"))
load(here("data","data_constructed","analytical_data.RData"))
```

# Introduction

  
# Background

# Data and Methods


# Results

# Levels of Educational Attainment
It is best to begin looking at the distribution of educational attainment of respondents.

```{r}
#| Label: fig-Educational_Attainment
#| fig-cap: Level of Educational Attainment Among Respondents. 
gss |>
  ggplot(aes(x=educ_attain, y=after_stat(prop), group=1))+
  geom_bar()+
  scale_y_continuous(labels=scales::percent)+
  labs(x="Education Level Attained", y=NULL, 
       title="Distribution of Education Level")+
  theme_bw()
```

As shown in @fig-Educational_Attainment 

```{r}
#| label: fig-Educational_Attainment_by_Race
#| fig-cap: Level of Educational Attainment of Respondents by Racial Identification.
gss |>  
  ggplot(aes(x=educ_attain, y=after_stat(prop), group=race, fill=race))+
  geom_bar(position="dodge")+
  #facet_wrap(~race)+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123","red", "blue", "black" ))+
  labs(x=NULL, y=NULL, 
       title="Education Level by Racial Identification")+
  coord_flip()+
  theme_bw()
```

As shown in @fig-Educational_Attainment_by_Race 

```{r}
#| label: fig-Education_by_Religious_Affiliation
#| fig-cap: Level of Educational Attainment  of Respondents by Religious Affiliation.
gss |>  
  ggplot(aes(x=educ_attain, y=after_stat(prop), group=relig_affil, fill=relig_affil))+
  geom_bar(position="dodge")+
  #facet_wrap(~race)+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123","red", "blue", "black", "orange", "grey", "pink", "purple" ))+
  labs(x=NULL, y=NULL, 
       title="Education Level by Religious Affiliation")+
  coord_flip()+
  theme_bw()
```

As shown in @fig-Education_by_Religious_Affiliation

```{r}
#| Label: fig-Religiousity_by_Education_and_Race
#| fig-cap: Religiousity by Repsondents Education Level and Race
gss |>
  group_by(race, educ_attain) |>
  summarize(religiosity=mean(religiosity)) |>
  ungroup() |>
  ggplot(aes(x=race, y=religiosity, fill=educ_attain))+
  geom_col(position="dodge")+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123","red", "blue", "black", "orange", "grey", "pink", "purple"))+
  labs(x=NULL, y=NULL, 
       title="Religiosity by Education and Race")+
  theme_bw()
```

As shown in @fig-Religiosity_by_Education_and_Race 






# Potential Issues in Measuring Religiosity






# Religisoity as Measured Across Sex


```{r}
#| Label: fig-Religiousity_by_Sex
#| fig-cap: Religiousity by Repsondents Sex
gss |>
  group_by(resp_sex) |>
  summarize(religiosity=mean(religiosity)) |>
  ungroup() |>
  ggplot(aes(x=resp_sex, y=religiosity, fill=resp_sex))+
  geom_col(position="dodge")+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123"))+
  labs(x=NULL, y=NULL, 
       title="Religiosity by Sex")+
  theme_bw()
```

As shown in @fig-REligiosity_by_Sex


```{r}
#| Label: fig-Religiousity_by_Sex_and_Race
#| fig-cap: Religiousity by Repsondents Sex and Race
gss |>
  group_by(race, resp_sex) |>
  summarize(religiosity=mean(religiosity)) |>
  ungroup() |>
  ggplot(aes(x=race, y=religiosity, fill=resp_sex))+
  geom_col(position="dodge")+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123"))+
  labs(x=NULL, y=NULL, 
       title="Religiosity by Sex and Race")+
  theme_bw()
```

As shown in @fig-Religiosity_by_Sex_and_Race


```{r}
#| Label: fig-Religiousity_by_Education_and_Respondents_Sex
#| fig-cap: Religiousity by Repsondents Education Level and Sex
gss |>
  group_by(educ_attain, resp_sex) |>
  summarize(religiosity=mean(religiosity)) |>
  ungroup() |>
  ggplot(aes(x=educ_attain, y=religiosity, fill=resp_sex))+
  geom_col(position="dodge")+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123"))+
  labs(x=NULL, y=NULL, 
       title="Religiosity by Sex and Educational Level")+
  theme_bw()
```

As seen in @fig-Religiosity_by_Education_and_Respondents_Sex






# Religious Attendance
Religious attendance  

```{r}
#| label: fig-Religious_Attendance
#| fig-cap: Religious attendance of respondents. 
gss |>
  ggplot(aes(x=relig_attend, y=after_stat(prop), group=1))+
  geom_bar()+
  scale_y_continuous(labels=scales::percent)+
  labs(x="Religious Attendance", y=NULL, 
       title="Distribution of Religious Attendance")+
  theme_bw()
```

As shown in @fig-Religious_Attendance 





```{r}
#| label: fig-Religious_Attendance_by_Sex
#| fig-cap: Religious Attendance of Respondents by Sex.
gss |>  
  ggplot(aes(x=relig_attend, y=after_stat(prop), group=resp_sex, fill=resp_sex))+
  geom_bar(position="dodge")+
  #facet_wrap(~race)+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123"))+
  labs(x=NULL, y=NULL, 
       title="Religious Attendance by Sex")+
  coord_flip()+
  theme_bw()
```

As seen in @fig-REligious_Attendance_by_Sex
 


```{r}
#| label: fig-Religious_Attendance_by_Religious_Affiliation
#| fig-cap: Religious Attendance by Religious Affiliation
gss |>  
  ggplot(aes(x=relig_attend, y=after_stat(prop), group=relig_affil, fill=relig_affil))+
  geom_bar(position="dodge")+
  #facet_wrap(~race)+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123","red", "blue", "black", "orange", "grey", "pink", "purple" ))+
  labs(x=NULL, y=NULL, 
       title="Religious Attendance by Religious Affiliation")+
  coord_flip()+
  theme_bw()
```

As shown in @fig-Religious_Attendance_by_Religious_Affiliation





```{r}
#| label: fig-Religious_Attendance_by_Respondents_Sex_and_Religious_Affilation
#| fig-cap: Religious Attendence by Respondents Sex and Religious Affiliation
gss |>  
  ggplot(aes(x=relig_attend, y=after_stat(prop), group=resp_sex, fill=resp_sex))+
  geom_bar(position="dodge")+
  facet_wrap(~relig_affil)+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123"))+
  coord_flip()+
  theme_bw()
```

As seen in @fig-Religious_Attendance_by_Respondents_Sex_and_Religious_Affiliation



# Measuring Belief in God 



```{r}
#| Label: fig-Belief_in_God
#| fig-cap: Belief in God Among Respondents. 
gss |>
  ggplot(aes(x=believe_god, y=after_stat(prop), group=1))+
  geom_bar()+
  scale_y_continuous(labels=scales::percent)+
  labs(x="Belief in God", y=NULL, 
       title="Distribution of Belief in God")+
  theme_bw()
```

As seen in @fig-Belief_in_God 


```{r}
#| label: fig-Belief_in_God_by_Race
#| fig-cap: Belief in God of Respondents by Racial Identification.
gss |>  
  ggplot(aes(x=believe_god, y=after_stat(prop), group=race, fill=race))+
  geom_bar(position="dodge")+
  #facet_wrap(~race)+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123","red", "blue", "black" ))+
  labs(x=NULL, y=NULL, 
       title="Belief in God by Racial Identification")+
  coord_flip()+
  theme_bw()

```

As seen in @fig-Belief_in_God_by_Race



```{r}
#| label: fig-Beleif_in_God_by_Religious_Affiliation
#| fig-cap: Belief in God of Respondents by Religious Afiliation.
gss |>  
  ggplot(aes(x=believe_god, y=after_stat(prop), group=relig_affil, fill=relig_affil))+
  geom_bar(position="dodge")+
  #facet_wrap(~race)+
  #scale_fill_viridis_d()+
  scale_fill_manual(values=c("#154733","#FEE123","red", "blue", "black", "orange", "grey", "pink", "purple" ))+
  labs(x=NULL, y=NULL, 
       title="Belief in god by Religious Affiliation")+
  coord_flip()+
  theme_bw()
```

As seen in @fig-Belief_in_God-by_Religious_Affiliation




# Religiosity Models
  

```{r}
#| Label: Modeling Religiosity 
model1 <- glm(religiosity~educ_attain*age+I(age^2), data=gss)
model2 <- update(model1, .~.+educ_attain*race, data=gss)
model3 <- update(model2, .~.+resp_sex*race, data=gss)
model4 <- update(model3, .~.+relig_affil)
```

```{r}
#| label: fig-Rendering_Models
#| fig-cap: Models of religiosity by education and Race with interaction terms.
#| results: asis
#to print to screen replace texreg with screenreg
screenreg(list(model1, model2, model3, model4),
        #custom.coef.names = c("high school", "some college", "bachelors", "graduate",
                             # "black", "latinX", "asian", "asian/pi", "HS*black", ""),
       digits = 3,
       caption.above=TRUE, 
       include.rsquared=TRUE,
       include.adjrs=FALSE,
       include.nobs=TRUE,
       include.rmse=FALSE)
```

As seen in @fig-Rendering_Models 

```{r}
#| Label: Modeling Religiosity Continued
model5 <- glm(religiosity~resp_sex*race+educ_attain*race, data=gss)
model6 <- update(model5, .~.+resp_age+as.factor(year))
model7 <- update(model6, .~.+relig_affil)
model8 <- update(model7,.~.+relig_affil*resp_sex)
```

```{r}
#| label: fig-Rendering_Models_Continued
#| fig-cap: Models of Religiosity by Education, Race, and Sex with interaction terms.
#| results: asis
#to print to screen replace texreg with screenreg
screenreg(list(model5, model6, model7, model8),
        #custom.coef.names = c("high school", "some college", "bachelors", "graduate",
                             # "black", "latinX", "asian", "asian/pi", "HS*black", ""),
       digits = 3,
       caption.above=TRUE, 
       include.rsquared=TRUE,
       include.adjrs=FALSE,
       include.nobs=TRUE,
       include.rmse=FALSE)
```

As seen in @fig-Rendering_Models_Continued



# Conclusions
 

