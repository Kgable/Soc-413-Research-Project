---
title: "Religiosity be Education"
---

```{r}
#| label: setup
#| include: false
library(here)
source(here("utils","check_packages.R"))
source(here("utils","functions.R"))
load(here("data","data_constructed","analytical_data.RData"))
```



```{r}
#| Label: Levels of Educational Attainment
ggplot(gss, aes(x=edattain, y=after_stat(prop), group=1))+
  geom_bar()+
  scale_y_continuous(labels=scales::percent)+
  labs(x="Education Level Attained", y=NULL, 
       title="Distribution of Education Level")+
  theme_bw()
```



```{r}
#| label: Education Level by Sex
ggplot(gss, aes(x=edattain, y=after_stat(prop), group=1))+
  geom_bar()+
  facet_wrap(~ssex)+
  scale_y_continuous(labels = scales::percent)+
  labs(x=NULL, y=NULL, 
       title="Educational Attainment by Sex")+
  coord_flip()+
  theme_bw()
```



```{r}
#| label: Religious Attendence 
ggplot(gss, aes(x=religattend, y=after_stat(prop), group=1))+
  geom_bar()+
  scale_y_continuous(labels=scales::percent)+
  labs(x="Religious Attendence", y=NULL, 
       title="Distribution of Religious Attendence")+
  theme_bw()
```

```{r}
#| label: Religious Attendence by Sex
ggplot(gss, aes(x=religattend, y=after_stat(prop), group=1))+
  geom_bar()+
  facet_wrap(~ssex)+
  scale_y_continuous(labels = scales::percent)+
  labs(x=NULL, y=NULL, 
       title="Religious Attendence by Sex")+
  coord_flip()+
  theme_bw()
```



```{r}
#| Label: 
ggplot(gss, aes(x=bcohort10, y=religattend))+
  geom_point()+
  #coord_flip()+
  theme_bw()+
  labs(x=NULL,
       y="Religious Attendence",
       title="Religious Attendence by Birth Cohort",
       caption="GSS data")
```




```{r}
#| Label: 
ggplot(gss, aes(x=bcohort10, y=prayfreq))+
  geom_point()+
  #coord_flip()+
  theme_bw()+
  labs(x=NULL,
       y="Prayer Frequency",
       title="Prayer Frequency by Birth Cohort",
       caption="GSS data")
```

```{r}
#| Label: 
ggplot(gss, aes(x=bcohort10, y=bgod))+
  geom_point()+
  #coord_flip()+
  theme_bw()+
  labs(x=NULL,
       y="Belief in God",
       title="Belief in God by Birth Cohort",
       caption="GSS data")
```

```{r}
temp <- gss |>
  group_by(year, bcohort10) |>
  summarize(m_religiosity=mean(religiosity, na.rm=TRUE))

ggplot(gss, aes(x=year, y=religiosity))
```


```{r}
#| Label: Modeling Religiosity by Cohort
model1<-glm(religiosity~bcohort10, data=gss)
model2<-glm(religiosity~bcohort10+edattain, data=gss)
model3<-glm(religiosity~bcohort10+edattain+ssex, data=gss)
```

```{r}
#| Label: Rendering Models
#to print to screen replace texreg with screenreg
screenreg(list(model1, model2, model3),
       custom.coef.names = c("intercept", "1900-1910", "1911-1920", "1921-1930",
                             "1931-1940", "1941-1950", "1951-1960",
                             "1961-1970", "1971-1980", "1981-1990",
                             "1991-2000", "2001-2010", "high school",
                             "some college", "bachelors", "graduate",
                             "female"),
       digits = 3,
       caption.above=TRUE, 
       include.rsquared=TRUE,
       include.adjrs=FALSE,
       include.nobs=TRUE,
       include.rmse=FALSE)
```


