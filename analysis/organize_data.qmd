---
title: "Religiosity by Education"
---

```{r}
#| label: setup
#| include: false
library(here)
source(here("utils","check_packages.R"))
source(here("utils","functions.R"))
```

## Reading in Raw Data

```{r}
#| label: read-data
gss <- read_fwf(here("data","data_raw","GSS.dat"), 
                col_positions = 
                  fwf_positions(start=c(6, 64, 29, 10, 25, 34, 39,
                                        49, 59),
                                end  =c(9, 68, 33, 14, 28, 38, 43,
                                        53, 64),
                                col_names=c("EDUC", "YEAR",
                                            "ATTEND", "SEX", "RELIG",
                                            "PRAY", "GOD",
                                            "AFTERLIF", "RELIGIMP")))


```

## Code variables

```{r}
#| label: code-vars
gss <- gss |>
  mutate(year=YEAR,
         educ=ifelse(EDUC<0, NA, EDUC),
         attend=ifelse(ATTEND<0, NA, ATTEND),
         sex=ifelse(SEX<0, NA, SEX),
         relig=ifelse(RELIG<0, NA, RELIG),
         pray=ifelse(PRAY<0, NA, PRAY),
         god=ifelse(GOD<0, NA, GOD),
         afterlif=ifelse(AFTERLIF<0, NA, AFTERLIF),
         religimp=ifelse(RELIGIMP<0, NA, RELIGIMP))

```

```{r}
#| label: check-ed
#table(gss$EDUC, gss$educ, exclude=NULL)
#table(gss$SEX, gss$sex, exclude=NULL)
#table(gss$ATTEND, gss$attend, exclude=NULL)
#table(gss$RELIG, gss$relig, exclude=NULL)
#table(gss$PRAY, gss$pray, exclude=NULL)
#table(gss$GOD, gss$god, exclude=NULL)
#table(gss$AFTERLIF, gss$afterlif, exclude=NULL)
table(gss$RELIGIMP, gss$religimp, exclude=NULL)
```

```{r}
#| label: creating religiosity variable

```

## Save it all

```{r}
#| label: save-analytical-data
gss <- gss |>
  select(year, educ, sex, relig,)

save(gss, file=here("data","data_constructed","analytical_data.RData"))
```